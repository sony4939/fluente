<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Italian Tutor Pro</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-top">
                <h1 class="logo"><span class="italian-flag-text">Fluente</span></h1>
                <button id="btn-settings" class="icon-btn" title="Settings" aria-label="Open Settings">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none"
                        class="settings-icon">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path
                            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                        </path>
                    </svg>
                </button>
            </div>
            <p class="subtitle">Your Accelerated Italian Journey</p>
        </header>

        <!-- Navigation Tabs -->
        <nav class="main-nav">
            <button class="glass-btn tab-btn active" data-target="view-learn">Flashcards</button>
            <button class="glass-btn tab-btn" data-target="view-practice">Quiz</button>
            <button class="glass-btn tab-btn" data-target="view-converse">Conversation</button>
        </nav>

        <!-- Main Content Area -->
        <main class="content-area">

            <!-- VIEW: LEARN (Flashcards) -->
            <section id="view-learn" class="view-section active">
                <div class="view-header">
                    <h2>Vocabulary Flashcards</h2>
                    <div class="category-selector">
                        <select id="category-select" class="glass-select">
                            <option value="greetings">Greetings & Basics</option>
                            <option value="travel">Travel & Directions</option>
                            <option value="food">Food & Dining</option>
                            <option value="verbs">Essential Verbs</option>
                            <option value="family">Family & People</option>
                            <option value="shopping">Shopping & Money</option>
                            <option value="custom">★ My Mistakes (From Conversations) ★</option>
                        </select>
                    </div>

                    <div class="flashcard-container">
                        <div class="flashcard">
                            <div class="flashcard-inner">
                                <div class="flashcard-front">
                                    <span class="card-label">Italian</span>
                                    <h3 id="card-it" class="card-word">Ciao</h3>
                                    <button id="btn-listen" class="icon-btn" title="Listen"
                                        aria-label="Listen to pronunciation">
                                        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor"
                                            stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                                            <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07">
                                            </path>
                                        </svg>
                                    </button>
                                </div>
                                <div class="flashcard-back">
                                    <span class="card-label">English</span>
                                    <h3 id="card-en" class="card-word">Hello / Goodbye</h3>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card-controls">
                        <button id="btn-prev" class="glass-btn">Previous</button>
                        <span id="card-counter" class="counter">1 / 10</span>
                        <button id="btn-next" class="glass-btn primary">Next</button>
                    </div>
            </section>

            <!-- VIEW: PRACTICE (Quick Quizzes) -->
            <section id="view-practice" class="view-section">
                <div class="view-header">
                    <h2>Rapid Quiz</h2>
                    <p class="quiz-status">Score: <span id="quiz-score">0</span></p>
                </div>

                <div id="quiz-setup" class="quiz-setup">
                    <p class="setup-text">Test your knowledge! You'll get 10 random words to translate before the time
                        runs out.</p>
                    <div style="margin-bottom: 1.5rem;">
                        <label for="quiz-category-select"
                            style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.25rem; display: block;">Select
                            Category:</label>
                        <select id="quiz-category-select" class="glass-select full-width">
                            <option value="all">Mix: All Categories</option>
                            <option value="greetings">Greetings & Basics</option>
                            <option value="travel">Travel & Directions</option>
                            <option value="food">Food & Dining</option>
                            <option value="verbs">Essential Verbs</option>
                            <option value="family">Family & People</option>
                            <option value="shopping">Shopping & Money</option>
                            <option value="custom">★ My Mistakes (From Conversations) ★</option>
                        </select>
                    </div>
                    <button id="btn-start-quiz" class="glass-btn primary full-width">Start Quiz</button>
                </div>

                <div id="quiz-active" class="quiz-panel hidden">
                    <div class="progress-bar">
                        <div id="quiz-timer" class="progress-fill"></div>
                    </div>
                    <div class="question-container">
                        <span class="card-label">What does this mean?</span>
                        <h2 id="quiz-question-word" class="quiz-word">Grazie</h2>
                    </div>
                    <div class="options-grid" id="quiz-options">
                        <!-- Options will be injected here via JS -->
                    </div>
                </div>

                <div id="quiz-result" class="quiz-panel hidden center-content">
                    <h3>Quiz Complete!</h3>
                    <p class="final-score">Your Score: <span id="quiz-final-score">0</span>/10</p>
                    <button id="btn-restart-quiz" class="glass-btn primary">Play Again</button>
                </div>
            </section>

            <!-- VIEW: CONVERSE (Roleplay) -->
            <section id="view-converse" class="view-section">
                <div class="view-header">
                    <h2>Conversation Roleplay <span class="badge new-badge">New</span></h2>
                    <div class="speed-control">
                        <label for="speech-rate">Speed:</label>
                        <select id="speech-rate" class="glass-select small">
                            <option value="0.8">0.8x (Slow)</option>
                            <option value="1.0" selected>1.0x (Normal)</option>
                            <option value="1.2">1.2x (Fast Native)</option>
                            <option value="1.5">1.5x (Super Fast)</option>
                        </select>
                    </div>
                </div>

                <div class="conversation-setup">
                    <p class="setup-text">Chat with a dynamic AI tutor to practice your Italian. The tutor will evaluate
                        your skills and remember your progress!</p>

                    <div class="settings-row" style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                        <div style="flex: 1;">
                            <label for="level-select"
                                style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.25rem; display: block;">Your
                                Level:</label>
                            <select id="level-select" class="glass-select full-width">
                                <option value="A1">A1 (Beginner) - Short & simple</option>
                                <option value="A2">A2 (Elementary) - Basic phrasing</option>
                                <option value="B1" selected>B1 (Intermediate) - Conversational</option>
                                <option value="B2">B2 (Upper Intermediate) - Complex</option>
                            </select>
                        </div>
                        <div style="flex: 1;">
                            <label for="scenario-select"
                                style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.25rem; display: block;">Topic
                                Focus:</label>
                            <select id="scenario-select" class="glass-select full-width">
                                <option value="free">Dynamic & Abstract Chat</option>
                                <option value="culture">Discussing Culture</option>
                                <option value="debate">Friendly Debate</option>
                                <option value="cafe">Warmup: Ordering at a Cafe</option>
                                <option value="travel">Warmup: Hotel & Traveling</option>
                                <option value="shopping">Warmup: Shopping & Clothes</option>
                                <option value="hobbies">Chat: My Hobbies & Interests</option>
                            </select>
                        </div>
                    </div>

                    <button id="btn-start-chat" class="glass-btn primary full-width">Start Conversation</button>

                    <div class="memory-dashboard mt-4">
                        <h3>Your Progress</h3>
                        <div class="memory-grid">
                            <div class="memory-card">
                                <h4>Strengths</h4>
                                <ul id="memory-strengths">
                                    <li>No data yet. Keep talking!</li>
                                </ul>
                            </div>
                            <div class="memory-card">
                                <h4>Areas to Improve</h4>
                                <ul id="memory-weaknesses">
                                    <li>No data yet. Keep talking!</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="chat-interface" class="chat-container hidden">
                    <div class="chat-actions-top">
                        <button id="btn-end-session" class="glass-btn secondary small">End Chat & Get Notes</button>
                    </div>

                    <div class="chat-history" id="chat-history">
                        <!-- Chat bubbles injected here -->
                    </div>

                    <div class="chat-controls">
                        <div class="mic-dual-buttons">
                            <button id="btn-record-start" class="glass-btn success">
                                <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2"
                                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                </svg>
                                Start Speaking
                            </button>
                            <button id="btn-record-stop" class="glass-btn danger hidden">
                                <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2"
                                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                </svg>
                                Done Speaking
                            </button>
                        </div>
                        <div class="mic-status" id="mic-status">Press Start Speaking when ready...</div>
                    </div>
                    <div id="user-transcript" class="transcript-preview"></div>
                </div>

                <div id="session-summary" class="summary-panel hidden">
                    <h2>Conversation Notes</h2>
                    <p class="help-text mb-4">Here is a concise summary of the mistakes and new words from this session.
                    </p>
                    <div id="summary-content" class="markdown-content"></div>
                    <button id="btn-close-summary" class="glass-btn primary full-width mt-4">Back to Menu</button>
                </div>
            </section>

        </main>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button id="btn-close-settings" class="icon-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="setting-group">
                        <label for="api-key-input">OpenAI (ChatGPT) API Key</label>
                        <p class="help-text">Required for the organic Converse module. Get a key from <a
                                href="https://platform.openai.com/api-keys" target="_blank" rel="noopener">OpenAI
                                Settings</a>. (Saved locally in your browser).</p>
                        <input type="password" id="api-key-input" class="glass-input" placeholder="sk-...">
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="btn-save-settings" class="glass-btn primary w-full">Save Settings</button>
                </div>
            </div>
        </div>

    </div>

    <script src="app.js"></script>
</body>

</html>